# Отчёт по лабораторной работе 11
## Алгоритмы на строках

**Дата:** 18.12.2025
**Семестр:** 3 курс 1 полугодие - 5 семестр
**Группа:** ПИЖ-б-о-23-2-1
**Дисциплина:** Анализ сложности алгоритмов
**Студент:** Чекалин Егор Юрьевич

## Характеристики ПК для тестирования
Модель устройства: ASUS TUF Gaming A15
CPU: AMD Ryzen 7 7735HS 3.2 GHz
GPU: Nvidia GeForce RTX 4060 Mobile
RAM: 16 GB
SSD: 100 GB

## Цель работы

Изучить специализированные алгоритмы для эффективной работы со строками. Освоить
методы поиска подстрок, вычисление префикс-функции и Z-функции. Получить практические навыки
реализации и анализа алгоритмов обработки строк, исследовать их производительность.

## Практическая часть

### Выполненные задачи
- [x] **Задача 1**: Реализация вычисления префикс-функции для строки
- [x] **Задача 2**: Реализация алгоритма Кнута-Морриса-Пратта (KMP) для поиска подстроки
- [x] **Задача 3**: Реализация вычисления Z-функции строки
- [x] **Задача 4**: Реализация дополнительных алгоритмов поиска подстроки (Бойера-Мура и Рабина-Карпа)
- [x] **Задача 5**: Проведение сравнительного анализа эффективности алгоритмов на различных типах данных

## Результаты выполнения

### Пример работы программы

```bash
============================================================
АЛГОРИТМ БОЙЕРА-МУРА:
============================================================
Текст: 'ABABDABACDABABCABAB'
Шаблон: 'ABABCABAB'
Позиции: [10]

Текст: 'AABAACAADAABAABA'
Шаблон: 'AABA'
Позиции: [0, 9, 12]

============================================================
АЛГОРИТМ РАБИНА-КАРПА:
============================================================
Текст: 'ABABDABACDABABCABAB'
Шаблон: 'ABABCABAB'
Позиции: [10]

Текст: 'AABAACAADAABAABA'
Шаблон: 'AABA'
Позиции: [0, 9, 12]

==================================================
Z-ФУНКЦИЯ:
==================================================
Строка: XYXY            → z = [4, 0, 2, 0]
Строка: ZZZZ            → z = [4, 3, 2, 1]

==================================================
ПОИСК ПОДСТРОКИ:
==================================================
Текст: 'ABABDABACDABABCABAB'
Шаблон: 'ABABCABAB'
Позиции: [10]
```

### Результаты тестирования

```bash
======================================================================
Ran 39 tests in 0.004s

OK

Все тесты пройдены успешно:
• Префикс-функция (6 тестов)
• Алгоритм KMP (9 тестов)
• Z-функция (6 тестов)
• Алгоритм Бойера-Мура (6 тестов)
• Алгоритм Рабина-Карпа (6 тестов)
• Консистентность алгоритмов (2 теста)
• Практические задачи (3 теста)
• Интеграционные тесты (1 тест)
```

### Сравнительный анализ алгоритмов

#### Производительность на различных сценариях

| Сценарий | KMP | Z-алгоритм | Бойер-Мур | Рабин-Карп | Лучший |
|----------|-----|------------|-----------|------------|--------|
| Малый алфавит (4 символа) | 1930.659 мкс | 4108.974 мкс | 2422.283 мкс | 8846.198 мкс | **KMP** |
| Полный алфавит (26 символов) | 1422.701 мкс | 3532.677 мкс | **627.304 мкс** | 8707.455 мкс | **Бойер-Мур** |
| Повторяющийся паттерн | 2158.292 мкс | 4925.064 мкс | **1468.619 мкс** | 7972.996 мкс | **Бойер-Мур** |
| Однотипные символы | **3575.306 мкс** | 8618.253 мкс | 7945.443 мкс | 7140.544 мкс | **KMP** |
| Паттерн отсутствует | **1332.222 мкс** | 3426.623 мкс | 1607.920 мкс | 4942.648 мкс | **KMP** |

#### Масштабируемость (время в микросекундах)

| Размер текста | KMP | Z-алгоритм | Рабин-Карп |
|---------------|-----|------------|------------|
| 1000 | 134.19 мкс | 394.76 мкс | 900.22 мкс |
| 5000 | 683.98 мкс | 2020.79 мкс | 4685.94 мкс |
| 10000 | 1499.03 мкс | 4067.13 мкс | 11095.81 мкс |
| 50000 | 10100.71 мкс | 32711.69 мкс | 48716.02 мкс |
| 100000 | 27070.79 мкс | 74532.63 мкс | 87872.99 мкс |

#### Влияние длины паттерна (текст 50000 символов)

| Длина паттерна | KMP | Z-алгоритм | Рабин-Карп |
|----------------|-----|------------|------------|
| 1 | 10126.61 мкс | 23877.95 мкс | 20991.86 мкс |
| 10 | 9050.60 мкс | 21142.48 мкс | 42337.09 мкс |
| 50 | 8959.36 мкс | 21145.00 мкс | 42399.62 мкс |
| 100 | 9061.41 мкс | 21149.78 мкс | 42514.03 мкс |

### Визуализация результатов

![Сводная визуализация](00_summary_visualization.png)
*Сводная информация о производительности алгоритмов*

![Сравнение алгоритмов](01_algorithm_comparison.png)
*Сравнение времени выполнения на различных тестовых сценариях*

![Масштабируемость](02_scalability.png)
*Зависимость времени выполнения от размера текста*

![Влияние длины паттерна](03_pattern_size_influence.png)
*Влияние длины паттерна на производительность*

![Анализ худших случаев](04_worst_case_analysis.png)
*Производительность в неблагоприятных условиях*

![Визуализация префикс-функции](05_prefix_function_visualization.png)
*Графическое представление префикс-функции*

![Визуализация Z-функции](06_z_function_visualization.png)
*Графическое представление Z-функции*

### Файловая структура проекта

```
.
├── 00_summary_visualization.png
├── 01_algorithm_comparison.png
├── 02_scalability.png
├── 03_pattern_size_influence.png
├── 04_worst_case_analysis.png
├── 05_prefix_function_visualization.png
├── 06_z_function_visualization.png
├── analysis.py
├── benchmark_results.json
├── kmp_search.py
├── prefix_function.py
├── string_matching.py
├── tests.py
├── visualisation.py
└── z_function.py
```

## Выводы

1. **Алгоритм KMP** демонстрирует наиболее стабильную производительность в различных условиях, особенно эффективен при работе с малыми алфавитами и в случаях, когда паттерн не найден. Его гарантированная линейная сложность O(n+m) делает его надежным выбором для критических приложений.

2. **Алгоритм Бойера-Мура** показывает выдающиеся результаты при работе с большими алфавитами (26 символов), превосходя KMP в 2-3 раза. Использование эвристики "плохого символа" позволяет ему пропускать значительные участки текста при несовпадениях, что особенно эффективно при поиске в естественных языках.

3. **Алгоритм Рабина-Карпа**, несмотря на более высокое время выполнения в большинстве тестов, имеет уникальное преимущество — возможность одновременного поиска нескольких паттернов за один проход по тексту, что делает его незаменимым в специализированных сценариях.

4. **Z-алгоритм** показал наихудшие результаты по скорости, однако он остается ценным инструментом для анализа строк благодаря простоте реализации и возможности решения дополнительных задач (поиск периода, проверка циклических сдвигов).

5. Длина паттерна оказывает минимальное влияние на производительность алгоритмов KMP и Z-функции, в то время как для алгоритма Рабина-Карпа наблюдается заметное увеличение времени выполнения с ростом длины паттерна.

## Ответы на контрольные вопросы

1. **Что такое префикс-функция строки? Как она используется в алгоритме Кнута-Морриса-Пратта (KMP)?**  
Префикс-функция строки — это массив значений, где каждый элемент π[i] равен длине наибольшего собственного префикса подстроки s[0..i], который одновременно является её суффиксом. В алгоритме KMP префикс-функция используется для определения максимального сдвига паттерна при обнаружении несовпадения, что позволяет избежать возвратов в тексте и обеспечивает линейную сложность алгоритма.

2. **В чем основное преимущество алгоритма KMP перед наивным алгоритмом поиска подстроки? Проиллюстрируйте на примере.**  
Основное преимущество KMP — отсутствие возвратов в тексте. Например, при поиске паттерна "AAAAAB" в тексте "AAAAAAAAAB" наивный алгоритм будет многократно сдвигаться на одну позицию и проверять паттерн с начала, в то время как KMP использует префикс-функцию для определения, что после несовпадения можно сдвинуть паттерн на несколько позиций сразу, пропуская заведомо бесперспективные проверки.

3. **Опишите, что такое Z-функция строки. Как с ее помощью можно решить задачу поиска подстроки?**  
Z-функция строки — это массив, где z[i] равно длине наибольшей подстроки, начинающейся с позиции i, которая совпадает с префиксом всей строки. Для поиска подстроки с помощью Z-функции формируется строка "pattern#text", затем вычисляется Z-функция для этой объединённой строки. Позиции, где z[i] равно длине паттерна, соответствуют вхождениям паттерна в текст.

4. **В чем заключается идея алгоритма Бойера-Мура? Какие эвристики он использует для ускорения поиска?**  
Идея алгоритма Бойера-Мура заключается в сравнении паттерна с текстом справа налево, что позволяет обнаруживать несовпадения раньше. Алгоритм использует две основные эвристики: эвристику "плохого символа" (при несовпадении сдвигает паттерн так, чтобы символ текста совпал с последним его вхождением в паттерн) и эвристику "хорошего суффикса" (использует информацию о совпавших суффиксах для определения безопасного сдвига).

5. **Для каких практических задач, помимо поиска подстроки, могут применяться префикс- и Z-функции (например, поиск периода строки)?**  
Помимо поиска подстроки, префикс- и Z-функции применяются для: поиска наименьшего периода строки (используется в алгоритмах сжатия данных), проверки строки на палиндромность, поиска наибольшей повторяющейся подстроки, проверки того, является ли одна строка циклическим сдвигом другой, разбиения строки на непересекающиеся повторяющиеся паттерны, а также в алгоритмах обработки ДНК-последовательностей для поиска повторяющихся фрагментов.